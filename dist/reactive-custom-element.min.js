!function(a,b){typeof exports==='object'&&typeof module!=='undefined'?b(exports,require('lit-html'),require('reactive-data-store')):typeof define==='function'&&define.amd?define(['exports','lit-html','reactive-data-store'],b):(a=a||self, b(a.store={},a.litHtml,a.reactiveDataStore))}(this,function(a,b,c){'use strict';let f='';function g(a){return a!=null&&typeof a==='object'&&Array.isArray(a)===!1}class h extends HTMLElement{static defineTag(a){window.customElements.define(a,this)}constructor(a){super();this.html=b.html;this.renderTemplate=b.render;this.root=this;this.events=[];this.rendered=!1;g(a)&&(this.setShadowRoot(a),this.stylesheets=a.stylesheets||[])}setShadowRoot({shadowMode:a = 'open',styles:b = !1}){this.attachShadow({mode:a});this.root=this.shadowRoot;b.substring&&(this.styles=document.createElement('style'),this.styles.innerHTML=b)}connectedCallback(){this.render()}disconnectedCallback(){this.events.forEach(a=>a())}setAttribute(a,b){super.setAttribute(a,String(b));this[a]=b}setTabindex(a = 0){this.hasAttribute('tabindex')||this.setAttribute('tabindex',a)}setDisabled(a = !1){this.hasAttribute('disabled')||(this.disabled=a)}target(a){return a.composedPath()[0]||a.target}targetTagName(a){return this.target(a).tagName}on(a,b,c){c||(c=b,b=this);b.addEventListener(a,c);let d=()=>b.removeEventListener(a,c);this.events.push(d);return d}off(a,b){this.removeEventListener(a,b)}once(a,b,c){c||(c=b,b=this)}onNextRender(a,b){b||(b=a,a=this);this.once('rendered',a,b)}dispatch(a,b,c = !1){let d=new CustomEvent(a,{composed:!0,bubbles:!0,detail:c||b});b instanceof HTMLElement?b.dispatchEvent(d):this.dispatchEvent(d)}selector(a){return this.root.querySelector(a)}selectorAll(a){return this.root.querySelectorAll(a)}selectorAllArray(a){return[...this.root.querySelectorAll(a)]}setContent(a){this.innerHTML=a;this.render()}getSlotElements(a){return a.querySelector('slot').assignedNodes().filter(a=>a.nodeType===1)}buildStylesheets(){if(!this.stylesheets||this.selector('link')){return void 0}this.stylesheets.map(a=>{let b=document.createElement('link');b.setAttribute('rel','stylesheet');b.setAttribute('href',f+a+'.css');this.root.appendChild(b)})}preRenderCheck(){return !0}render(){if(!this.preRenderCheck()){return""}this.beforeRender();let a=this.template()||this.html"";this.renderTemplate(a,this.root);this.buildStylesheets();this.styles&&(this.selector('style')||this.root.appendChild(this.styles));setTimeout(()=>{this.rendered||(this.onFirstRender(),this.rendered=!0);this.onRender();this.dispatch('rendered')},200)}beforeRender(){}onRender(){}onFirstRender(){}template(){}}function i(a){f=a}let j=!1,k=Symbol('data');class l extends h{static get observedAttributes(){return['data-store']}constructor(a){super(a);this[k]={};this.subscriptions={}}get data(){return this[k]}set data(a){this[k]=a}get props(){return this[k]}disconnectedCallback(){super.disconnectedCallback();this.unsubscribeFromAllStores()}attributeChangedCallback(a){a==='data-store'&&(this.setStore(),setTimeout(this.render.bind(this)))}beforeUpdate(){}updateData(a){return(b,c,d)=>{this.beforeUpdate();a?this.data[a]=b:this.data=b;this.render();j&&setTimeout(()=>{console.log(`%c🍊  ${this.tagName.toLowerCase()} re-rendered`,"color: #E67E22;line-height:1;")},1100)}}setStore(a){let b=Boolean(a),d=c.parse(a||this.dataset.store);Array.isArray(d)?d.map(a=>this.subscribeToStore(a,b)):this.subscribeToStore(d,b)}subscribeToStore(a,b = !1){let{name:d,store:e,storePath:f,just:g,not:h}=a,i=this.tagName.replace('-','');this.unsubscribeFromStore(d||i);this.subscriptions[d||i]=c.Store(e).subscribe({callback:this.updateData(d).bind(this),storePath:f,just:g,not:h,name:d});d?(this.data[d]=c.getDataFromPath({storePath:f,just:g,not:h,data:c.Data(e)})):(this.data=c.getDataFromPath({storePath:f,just:g,not:h,data:c.Data(e)}));b&&this.render()}unsubscribeFromStore(a){this.subscriptions[a]&&this.subscriptions[a].unsubscribe()}unsubscribeFromAllStores(){Object.keys(this.subscriptions)&&(Object.values(this.subscriptions).map(a=>{a.unsubscribe()}),this.subscriptions={})}}h.debug=a=>{j=a};a.CustomElement=h;a.setStylesheetsRoot=i;a.ReactiveCustomElement=l;Object.defineProperty(a,'__esModule',{value:!0})})
//# sourceMappingURL=reactive-custom-element.min.js.map
